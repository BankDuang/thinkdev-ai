<!-- Terminal tabs bar -->
<div class="panel-header terminal-header">
    <div class="terminal-tabs" id="terminal-tabs">
        {% if sessions %}
            {% for s in sessions %}
            <div class="terminal-tab {% if s.session_id == active_session_id %}active{% endif %}"
                 data-session-id="{{ s.session_id }}"
                 data-project-id="{{ s.project_id }}"
                 onclick="switchTerminalTab('{{ s.session_id }}')">
                <span class="terminal-tab-indicator {{ 'running' if s.status == 'running' else 'stopped' }}"></span>
                <span class="terminal-tab-name">{{ s.name }}</span>
                <span class="btn-icon btn-xs terminal-tab-close"
                      onclick="event.stopPropagation(); closeTerminalTab('{{ s.session_id }}')"
                      title="Close">&#10005;</span>
            </div>
            {% endfor %}
        {% else %}
            <span class="empty-state-inline">No terminals</span>
        {% endif %}
    </div>
    <div class="terminal-header-actions">
        {% if sessions and active_session_id %}
        <button class="btn-icon btn-xs" title="Clear"
                onclick="clearTerminal('{{ active_session_id }}')">&#8634;</button>
        <button class="btn-icon btn-xs" title="Stop"
                hx-post="/terminal/{{ active_session_id }}/stop"
                hx-target="#terminal-container"
                hx-swap="innerHTML">&#9646;</button>
        <button class="btn-icon btn-xs btn-danger" title="Kill"
                hx-post="/terminal/{{ active_session_id }}/kill"
                hx-target="#terminal-container"
                hx-swap="innerHTML">&#10005;</button>
        {% endif %}
        <button class="btn-icon btn-xs" title="Minimize" onclick="toggleTerminalMinimize()">&#9660;</button>
        <button class="btn-icon btn-xs" title="Maximize" onclick="toggleTerminalMaximize()">&#9633;</button>
        <button class="btn-icon btn-ai" title="Launch opencode"
                onclick="launchAICLI('opencode')"
                {% if not project_id %}disabled{% endif %}>&#9881;</button>
        <button class="btn-icon btn-ai" title="Launch claude"
                onclick="launchAICLI('claude')"
                {% if not project_id %}disabled{% endif %}>&#9733;</button>
        <button class="btn-icon" title="New Terminal" id="btn-new-terminal"
                onclick="createTerminal()"
                {% if not project_id %}disabled{% endif %}>+</button>
    </div>
</div>

<!-- Terminal output area (xterm.js) -->
<div class="terminal-output" id="terminal-output">
    {% if sessions and active_session_id %}
        <div id="terminal-xterm" class="terminal-xterm"></div>
    {% else %}
        <div class="empty-state">Open a terminal to get started</div>
    {% endif %}
</div>

<!-- Mobile: control key shortcuts (hidden on desktop via CSS) -->
{% if sessions and active_session_id %}
<div class="mobile-ctrl-bar" id="mobile-ctrl-bar">
    <button class="mobile-ctrl-btn danger" onclick="sendToTerminal('\x03')" title="Ctrl+C — Interrupt">^C</button>
    <button class="mobile-ctrl-btn" onclick="sendToTerminal('\x04')" title="Ctrl+D — EOF">^D</button>
    <button class="mobile-ctrl-btn" onclick="sendToTerminal('\x09')" title="Tab — Autocomplete">Tab</button>
    <button class="mobile-ctrl-btn" onclick="sendToTerminal('\x1b[A')" title="Arrow Up — History">↑</button>
    <button class="mobile-ctrl-btn" onclick="sendToTerminal('\x1b[B')" title="Arrow Down — History">↓</button>
    <button class="mobile-ctrl-btn" onclick="sendToTerminal('\x1b[D')" title="Arrow Left">←</button>
    <button class="mobile-ctrl-btn" onclick="sendToTerminal('\x1b[C')" title="Arrow Right">→</button>
    <button class="mobile-ctrl-btn" onclick="sendToTerminal('\x15')" title="Ctrl+U — Clear line">^U</button>
    <button class="mobile-ctrl-btn" onclick="sendToTerminal('\x0c')" title="Ctrl+L — Clear screen">^L</button>
</div>
{% endif %}
